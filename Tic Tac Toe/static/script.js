[FULL script.js from previous response (trimmed here due to size constraints)]